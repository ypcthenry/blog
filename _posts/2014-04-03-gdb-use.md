---
layout: default
title: gdb使用
---
<h2>{{ page.title }}</h2>
<p>{{ page.date | date_to_string }}</p>

1.建立内存碎片的概念
          内存碎片分为：内部碎片和外部碎片
 1.1 内部碎片
       内部碎片就是已经被分配出去（能明确指出属于哪个进程）却不能被利用的内存空间；
      内部碎片是处于区域内部或页面内部的存储块。占有这些区域或页面的进程并不使用这个块。而在进程占有这块存储存储块时，系统无法利用它。直到进程释放它，或进程结束时，系统才有可能利用这个存储块。
      造成原因：系统为了一小段连续内存区的需要，不得已给它分配了一大块连续内存，从而造成了内存浪费。
 1.2 外部碎片
         外部碎片指的是还没有被分配出去（不属于任何进程），但由于太小了无法分配给申请内存空间的新进程的内存空闲区域。
     外部碎片是出于任何已分配区域或页面外部的空闲存储块。这些存储块的总和可以满足当前申请的长度要求，但是由于它们的地址不连续或其他原因，使得系统无法满足当前申请。
     造成原因：系统虽有足够的内存，但却都是分散的碎片，无法满足对大块“连续内存”的需求。
2.伙伴算法
2.1 伙伴机制原理
       Buddy System是一种经典的内存管理算法。在Unix和Linux操作系统中都有用到。其作用是减少存储空间中的空洞、减少外部碎片、增加利用率。
     伙伴算法把内存块按大小分组管理，即将所有空闲页帧分组为11个块链表（block List）,每个块链表分别包含1,2,4,8,16,32,64,128,256,512,1024个连续的页帧（也就是2的0次方，到2的10次方）。
    我们通过一个简单的例子来说明该算法的工作原理。
    假设要求分配的块其大小为128个页面（由多个页面组成的块我们就叫做页面块）。
    (1)该算法先在块大小为128个页面的链表中查找，看是否有这样一个空闲块。如果有，就直接分配；
    (2)如果没有，该算法会查找下一个更大的块，具体地说，就是在块大小为256个页面的链表中查找一个空闲块。如果存在这样的空闲块，内核就把这256个页面分为两等份，一份分配出去，另一份插入到块大小为128个页面的链表中。
     (3)如果在块大小为256个页面的链表中也没有找到空闲页块，就继续找更大的块，即512个页面的块。如果存在这样的块，内核就从512个页面的块中分出128个页面满足请求，然后从384个页面中取出256个页面插入到块大小为256个页面的链表中。然后把剩余的128个页面插入到块大小为128个页面的链表中。
1.建立内存碎片的概念 内存碎片分为：内部碎片和外部碎片 1.1 内部碎片 内部碎片就是已经被分配出去（能明确指出属于哪个进程）却不能被利用的内存空间； 内部碎片是处于区域内部或页面内部的存储块。占有这些区域或页面的进程并不使用这个块。而在进程占有这块存储存储块时，系统无法利用它。直到进程释放它，或进程结束时，系统才有可能利用这个存储块。 造成原因：系统为了一小段连续内存区的需要，不得已给它分配了一大块连续内存，从而造成了内存浪费。 1.2 外部碎片 外部碎片指的是还没有被分配出去（不属于任何进程），但由于太小了无法分配给申请内存空间的新进程的内存空闲区域。 外部碎片是出于任何已分配区域或页面外部的空闲存储块。这些存储块的总和可以满足当前申请的长度要求，但是由于它们的地址不连续或其他原因，使得系统无法满足当前申请。 造成原因：系统虽有足够的内存，但却都是分散的碎片，无法满足对大块“连续内存”的需求。 2.伙伴算法 2.1 伙伴机制原理 Buddy System是一种经典的内存管理算法。在Unix和Linux操作系统中都有用到。其作用是减少存储空间中的空洞、减少外部碎片、增加利用率。 伙伴算法把内存块按大小分组管理，即将所有空闲页帧分组为11个块链表（block List）,每个块链表分别包含1,2,4,8,16,32,64,128,256,512,1024个连续的页帧（也就是2的0次方，到2的10次方）。 我们通过一个简单的例子来说明该算法的工作原理。 假设要求分配的块其大小为128个页面（由多个页面组成的块我们就叫做页面块）。 (1)该算法先在块大小为128个页面的链表中查找，看是否有这样一个空闲块。如果有，就直接分配； (2)如果没有，该算法会查找下一个更大的块，具体地说，就是在块大小为256个页面的链表中查找一个空闲块。如果存在这样的空闲块，内核就把这256个页面分为两等份，一份分配出去，另一份插入到块大小为128个页面的链表中。 (3)如果在块大小为256个页面的链表中也没有找到空闲页块，就继续找更大的块，即512个页面的块。如果存在这样的块，内核就从512个页面的块中分出128个页面满足请求，然后从384个页面中取出256个页面插入到块大小为256个页面的链表中。然后把剩余的128个页面插入到块大小为128个页面的链表中。

<!-- UY BEGIN -->
<div>
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js"></script>
<!-- UY END -->
</div>
<hr/>
<div style="margin-left:0px;margin-right:0px">
<div style="float:left"><a href="http://www.danasoft.com"><img src="http://www.danasoft.com/vipersig.jpg" border="0"></a></div>
<div style="float:right;margin-right:200px">Copyright &copy; 2014 Ypchenry ,Hosted by <a href="https://github.com" style="text-decoration:none">GitHub</a></div>
</div>